<div class="container">
  <header class="header">
    <div>
      <a routerLink="/menu" class="btn btn-secondary btn-sm">‚Üê Volver</a>
      <h1>Equipos</h1>
    </div>
    <a routerLink="/equipos/nuevo" class="btn btn-primary">
      + Agregar
    </a>
  </header>

  @if (loading()) {
    <div class="loading">Cargando equipos...</div>
  }

  @if (error()) {
    <div class="error">{{ error() }}</div>
  }

  @if (!loading() && !error()) {
    <!-- Vista de tabla para desktop -->
    <div class="table-container desktop-only">
      <table class="table">
        <thead>
          <tr>
            <th class="sortable" (click)="setSortField('nombre')">
              Nombre {{ getSortIcon('nombre') }}
            </th>
            <th>Descripci√≥n</th>
            <th class="sortable" (click)="setSortField('marca')">
              Marca {{ getSortIcon('marca') }}
            </th>
            <th class="sortable" (click)="setSortField('modelo')">
              Modelo {{ getSortIcon('modelo') }}
            </th>
            <th>Estado</th>
            <th class="sortable" (click)="setSortField('ambientecodigo')">
              Ambiente {{ getSortIcon('ambientecodigo') }}
            </th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          @for (equipo of equiposPaginados(); track equipo.id) {
            <tr>
              <td>{{ equipo.nombre }}</td>
              <td>{{ equipo.descripcion || '-' }}</td>
              <td>{{ equipo.marca }}</td>
              <td>{{ equipo.modelo }}</td>
              <td>{{ equipo.estado }}</td>
              <td>{{ equipo.ambientecodigo || 'Sin asignar' }}</td>
              <td class="actions">
                <a [routerLink]="['/equipos', equipo.id]" class="btn btn-sm btn-edit">
                  Editar
                </a>
                <button (click)="deleteEquipo(equipo.id!)" class="btn btn-sm btn-delete">
                  Eliminar
                </button>
              </td>
            </tr>
          } @empty {
            <tr>
              <td colspan="7" class="empty">No hay equipos</td>
            </tr>
          }
        </tbody>
      </table>

      <!-- Controles de paginaci√≥n (ESCRITORIO) -->
      @if (totalPages() > 1) {
        <div class="pagination">
          <button
            class="btn btn-sm btn-secondary"
            [disabled]="currentPage() === 1"
            (click)="prevPage()">
            ‚Üê Anterior
          </button>
          <span class="pagination-info">
            {{ equipos().length }} equipos - P√°gina {{ currentPage() }} de {{ totalPages() }}
          </span>
          <button
            class="btn btn-sm btn-secondary"
            [disabled]="currentPage() === totalPages()"
            (click)="nextPage()">
            Siguiente ‚Üí
          </button>
        </div>
      }
    </div>

    <!-- Vista de tarjetas para mobile -->
    <div class="cards-container mobile-only">
      @for (equipo of equipos(); track equipo.id) {
        <div class="card">
          <div class="card-header">
            <span class="card-nombre">{{ equipo.nombre }}</span>
            <span class="card-estado" [class]="equipo.estado?.toLowerCase()">{{ equipo.estado }}</span>
          </div>
          <div class="card-body" [routerLink]="['/equipos', equipo.id]">
            @if (equipo.descripcion) {
              <p class="card-descripcion">{{ equipo.descripcion }}</p>
            }
            <p class="card-marca">{{ equipo.marca }} - {{ equipo.modelo }}</p>
            <p class="card-ambiente" *ngIf="equipo.ambientecodigo">
              üìç {{ equipo.ambientecodigo }}
            </p>
          </div>
          <div class="card-actions">
            <a [routerLink]="['/equipos', equipo.id]" class="btn btn-sm btn-edit">
              Editar
            </a>
            <button (click)="deleteEquipo(equipo.id!)" class="btn btn-sm btn-delete">
              Eliminar
            </button>
          </div>
        </div>
      } @empty {
        <div class="empty-card">No hay equipos registrados</div>
      }
    </div>
  }
</div>
